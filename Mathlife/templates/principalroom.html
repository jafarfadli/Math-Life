<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/principalroom.css') }}">
</head>
<body>
    <header class="headerContainer" id="headerPage">
        <div class="topLeftContainer">
            <div class="itemContainer">
                <img class="itemIcon" src="{{url_for('static', filename='assets/user.png')}}">
                <input type="text" class="itemDisplay" id="usernameDisplay" value="{{name}}" disabled>
            </div>
        </div>

        <div class="titleContainer">
            <h1 class="title">Ruang Kepsek</h1>
        </div>
    </header>

    <div class="mapContainer">
        <div class="mapGrid cornerGrid" id="grid11"></div>
        <div class="mapGrid leftGrid" id="grid12"></div>
        <div class="mapGrid leftGrid" id="grid13"></div>
        <div class="mapGrid leftGrid" id="grid14"></div>
        <div class="mapGrid leftGrid" id="grid15"></div>
        <div class="mapGrid leftGrid" id="grid16"></div>
        <div class="mapGrid leftGrid" id="grid17"></div>
        <div class="mapGrid leftGrid" id="grid18"></div>
        <div class="mapGrid cornerGrid" id="grid19"></div>

        <div class="mapGrid topGrid" id="grid21"></div>
        <div class="mapGrid" id="grid22"><img class="avatar" id="avt22" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid23"><img class="avatar" id="avt23" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid24"><img class="avatar" id="avt24" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid25"><img class="avatar" id="avt25" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid26"><img class="avatar" id="avt26" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid27"><img class="avatar" id="avt27" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid28"><img class="avatar" id="avt28" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid bottomGrid" id="grid29"></div>

        <div class="mapGrid topGrid" id="grid31"></div>
        <div class="mapGrid" id="grid32"><img class="avatar" id="avt32" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid33"><img class="avatar" id="avt33" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid34"><img class="avatar" id="avt34" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid35"><img class="avatar" id="avt35" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid36"><img class="avatar" id="avt36" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid37"><img class="avatar" id="avt37" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid38"><img class="avatar" id="avt38" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid bottomGrid" id="grid39"><img class="window" src="{{url_for('static', filename='assets/window.png')}}"></div>

        <div class="mapGrid topGrid" id="grid41"></div>
        <div class="mapGrid" id="grid42"><img class="avatar" id="avt42" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid43"><img class="avatar" id="avt43" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid44"><img class="avatar" id="avt44" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid45"><img class="avatar" id="avt45" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid46"><img class="avatar" id="avt46" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid47"><img class="avatar" id="avt47" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid48"><img class="avatar" id="avt48" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid bottomGrid" id="grid49"></div>

        <div class="mapGrid topGrid" id="grid51"></div>
        <div class="mapGrid interactiveObj" id="grid52"><img class="principalDesk" src="{{url_for('static', filename='assets/principalDesk.png')}}"></div>
        <div class="mapGrid" id="grid53"><img class="avatar" id="avt53" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid54"><img class="avatar" id="avt54" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid55"><img class="avatar" id="avt55" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid56"><img class="avatar" id="avt56" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid57"><img class="avatar" id="avt57" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid58"><img class="avatar" id="avt58" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid bottomGrid" id="grid59"><img class="window" src="{{url_for('static', filename='assets/window.png')}}"></div>

        <div class="mapGrid topGrid" id="grid61"></div>
        <div class="mapGrid" id="grid62"><img class="avatar" id="avt62" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid63"><img class="avatar" id="avt63" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid64"><img class="avatar" id="avt64" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid65"><img class="avatar" id="avt65" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid66"><img class="avatar" id="avt66" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid67"><img class="avatar" id="avt67" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid68"><img class="avatar" id="avt68" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid bottomGrid" id="grid69"></div>

        <div class="mapGrid topGrid" id="grid71"><img class="avatar" id="avt71" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid72"><img class="avatar" id="avt72" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid73"><img class="avatar" id="avt73" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid74"><img class="avatar" id="avt74" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid75"><img class="avatar" id="avt75" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid76"><img class="avatar" id="avt76" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid77"><img class="avatar" id="avt77" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid78"><img class="avatar" id="avt78" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid bottomGrid" id="grid79"><img class="window" src="{{url_for('static', filename='assets/window.png')}}"></div>
            
        <div class="mapGrid topGrid" id="grid81"></div>
        <div class="mapGrid" id="grid82"><img class="avatar" id="avt82" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid83"><img class="avatar" id="avt83" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid84"><img class="avatar" id="avt84" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid85"><img class="avatar" id="avt85" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid86"><img class="avatar" id="avt86" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid87"><img class="avatar" id="avt87" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid" id="grid88"><img class="avatar" id="avt88" style="display:none;" src="{{url_for('static', filename='assets/avatar.png')}}"></div>
        <div class="mapGrid bottomGrid" id="grid89"></div>
        
        <div class="mapGrid cornerGrid" id="grid91"></div>
        <div class="mapGrid rightGrid" id="grid92"></div>
        <div class="mapGrid rightGrid" id="grid93"></div>
        <div class="mapGrid rightGrid" id="grid94"></div>
        <div class="mapGrid rightGrid doors interactiveObj" id="grid95"><img class="lsIcon" src="{{url_for('static', filename='assets/R6.png')}}"></div>
        <div class="mapGrid rightGrid" id="grid96"></div>
        <div class="mapGrid rightGrid" id="grid97"></div>
        <div class="mapGrid rightGrid" id="grid98"></div>
        <div class="mapGrid cornerGrid" id="grid99"></div>
    </div>

    <div class="alertContainer" id="alertContainer1" style="display:none;">
        <p class="alertText" id="narratorText1"></p>
        <div class="alertButtonContainer">
            <button class="alertButton" id="alertNoButton">Tidak</button>
            <button class="alertButton" id="alertYesButton">Ya</button>
        </div>
    </div>

    <div class="alertContainer" id="alertContainer2" style="display:none;">
        <p class="alertText" id="narratorText2"></p>
        <div class="alertButtonContainer">
            <button class="alertButton" id="alertContinueButton">Oke</button>
        </div>
    </div>

    <form class="alertContainer" id="manageUserContainer" style="display:none;" action="{{ url_for('principalroom') }}" method="POST">
        <p class="alertText">Manajemen Siswa</p>
        <input type="text" name="userUsername" id="userUsername" class="manageUserText" placeholder="Username" required>
        <input type="number" name="userCoins" id="userCoins" class="manageUserText" placeholder="new coins" required>
        <input type="number" name="userHintPotion" id="userHintPotion" class="manageUserText" placeholder="new hint Potion" required>
        <input type="number" name="userToolPotion" id="userToolPotion" class="manageUserText" placeholder="new tool Potion" required>
        <input type="number" name="userLifePotion" id="userLifePotion" class="manageUserText" placeholder="new life Potion" required>
        <div class="alertButtonContainer">
            <button class="alertButton" id="alertCancelButton">Batal</button>
            <button class="alertButton" id="alertViewUserButton">Lihat User</button>
            <input type="submit" class="alertButton" id="alertSendButton" value="Update" name="manageUser">
        </div>
    </form>

    <div class="alertContainer" id="userListContainer" style="display:none;">
        <p class="alertText">User Mathlife</p>
        <pre class="alertText userListText" id="userListText"></pre>
        <div class="alertButtonContainer">
            <button class="alertButton" id="alertBackButton">Kembali</button>
        </div>
    </div>

    <script>
        const alertContainer1 = document.getElementById('alertContainer1')
        const narratorText1 = document.getElementById('narratorText1')
        const alertNoButton = document.getElementById('alertNoButton')
        const alertYesButton = document.getElementById('alertYesButton')

        const alertContainer2 = document.getElementById('alertContainer2')
        const narratorText2 = document.getElementById('narratorText2')
        const alertContinueButton = document.getElementById('alertContinueButton')

        const manageUserContainer = document.getElementById('manageUserContainer')
        const userUsername = document.getElementById('userUsername')
        const userCoins = document.getElementById('userCoins')
        const userHintPotion = document.getElementById('userHintPotion')
        const userToolPotion = document.getElementById('userToolPotion')
        const userLifePotion = document.getElementById('userUsername')
        const alertCancelButton = document.getElementById('alertCancelButton')
        const alertViewUserButton = document.getElementById('alertViewUserButton')
        const alertSendButton = document.getElementById('alertSendButton')

        const userListContainer = document.getElementById('userListContainer')
        const userListText = document.getElementById('userListText')
        const alertBackButton = document.getElementById('alertBackButton')

        const user_list = {{ user_list | tojson }};

        let numUser = user_list.length;
        userList = '';
        for (let indexUser = 1; indexUser < numUser; indexUser++){
            userList += `Name: ${user_list[indexUser][1]}\nCoins: ${user_list[indexUser][3]}\nHint Potion: ${user_list[indexUser][4]}\nTool Potion: ${user_list[indexUser][5]}\nLife Potion: ${user_list[indexUser][5]}\n\n`;
        }
        userListText.textContent = userList;

        function avt(a,b){
            return document.getElementById(`avt${a}${b}`);
        }

        function alert1(text,link){
            alerted = true;
            alertContainer1.style.display='flex';
            narratorText1.textContent = `${text}`;

            alertNoButton.onclick = function(){
                alertContainer1.style.display='none';
                alerted = false;
            }
            alertYesButton.onclick = function(){
                window.location.href = `${link}`
            }
        }

        function alert2(text){
            alerted = true
            alertContainer2.style.display='flex';
            narratorText2.textContent = `${text}`;

            alertContinueButton.onclick = function(){
                alertContainer2.style.display='none';
                alerted = false;
            }
        }

        function manageUser(){
            alerted = true
            manageUserContainer.style.display='flex';

            alertCancelButton.onclick = function(){
                userUsername.value = '';
                userCoins.value = '';
                userHintPotion.value = '';
                userToolPotion.value = '';
                userLifePotion.value = '';
                manageUserContainer.style.display='none';
                alerted = false;
            }
            alertViewUserButton.onclick = function(){
                userUsername.value = '';
                userCoins.value = '';
                userHintPotion.value = '';
                userToolPotion.value = '';
                userLifePotion.value = '';
                manageUserContainer.style.display='none';

                userListContainer.style.display='flex';

                alertBackButton.onclick = function(){
                    userListContainer.style.display='none';
                    manageUser();
                }
            }
        }

        let alerted = false
        let position_x = 5;
        let position_y = 5;
        avt(position_x,position_y).style.display='block';;

        document.onkeydown = checkKey;

        function checkKey(e) {

            e = e || window.event;

            if (e.keyCode == '38' && !(alerted)) {
                // up arrow
                if ((position_x == 4 || position_x == 6) && position_y == 3){

                } else if (position_x == 5 && position_y == 3){
                    manageUser();
                } else if (position_y != 2){
                    avt(position_x,position_y).style.display='none';
                    position_y -= 1;
                    avt(position_x,position_y).style.display='block';
                }

            } else if (e.keyCode == '40' && !(alerted)) {
                // down arrow
                if (position_y != 8){
                    avt(position_x,position_y).style.display='none';
                    position_y += 1;
                    avt(position_x,position_y).style.display='block';
                }

            } else if (e.keyCode == '37' && !(alerted)) {
                // left arrow
                if (position_x == 7 && position_y == 2){

                } else if (position_x != 2){
                    avt(position_x,position_y).style.display='none';
                    position_x -= 1;
                    avt(position_x,position_y).style.display='block';
                }

            }
            else if (e.keyCode == '39' && !(alerted)){
                // right arrow
                if (position_x == 3 && position_y == 2){

                } else if (position_x == 8 && position_y == 5){
                    alert1('Masuk Lobi Sekolah?','homepage')
                } else if (position_x != 8){
                    avt(position_x,position_y).style.display='none';
                    position_x += 1;
                    avt(position_x,position_y).style.display='block';
                }
            }
        }
    </script>
</body>
</html>